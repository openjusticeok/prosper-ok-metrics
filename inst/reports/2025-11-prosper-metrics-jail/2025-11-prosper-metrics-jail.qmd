---
title: "`r paste0(if (isTRUE(params$draft)) '[DRAFT, NOT FOR EXTERNAL SHARING] ' else '', 'ProsperOK Metrics Report<br>for Tulsa County Jail,<br> Q4 2025')`"
subtitle: |
  November 2025 update on Tulsa County Jail Population and Bookings
format:
  ojo-report-template-html:
    theme: default
    mainfont: "Lora"
    header-includes: |
      <link rel="preconnect" href="https://fonts.googleapis.com">
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link href="https://fonts.googleapis.com/css2?family=Lato:wght@100;300;400;900&display=swap" rel="stylesheet">
      <link href="https://fonts.googleapis.com/css2?family=Lato:wght@100;300;400;900&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">
# Formatting options -----------------------------------------------------------
logo: "www/okpi-square.png" # Other options are in the /www/ directory
number-sections: true
smooth-scroll: true
title-block-banner: "#2f507f" # The background color for the header banner
title-block-banner-color: "white" # The text color for the header banner
fontcolor: "black" # Default text color for the body
linkcolor: "black" # Default link color for the body
toc: true # This should be 'false' if your end goal is a PDF
knitr:
  opts_chunk:
    fig.align: center
    echo: false
    message: false
    warning: false
    fig-width: 7
    fig-height: 5
    out-width: '100%'
# Document info ----------------------------------------------------------------
author: Anthony Flores
date: last-modified
description: |
    This is a status update report using data from the Tulsa County Jail. It was prepared and analyzed by the Oklahoma Policy Institute.
embed-resources: false
params:
  draft: true
  audience: "internal"
# abstract-title: Publication Note
# abstract: 'DRAFT REPORT -- NOT FOR PUBLICATION'
---

```{r draft-disclaimer, echo=FALSE, results='asis'}
if (isTRUE(params$draft)) {
  cat("::: {.callout-warning}\n**[DRAFT, NOT FOR EXTERNAL SHARING]**\nThis draft report is for internal use only.\n:::\n\n")
}
```

```{r, results="asis", echo=FALSE}
if (isTRUE(params$draft)) {
  cat('
<style>
body::before {
  content: "DRAFT â€“ NOT FOR EXTERNAL SHARING";
  position: fixed;
  top: 40%;
  left: 50%;
  transform: translate(-50%, -50%) rotate(-30deg);
  font-size: 5rem;
  font-weight: 900;
  color: #000;
  opacity: 0.06;
  pointer-events: none;
  z-index: 9999;
}
</style>
  ')
}
```

```{r}

# To render to PDF after you've rendered your .html document:
# pagedown::chrome_print("./report.html", "./report.pdf", format = "pdf")

# We'll build this into the YAML header so you don't have to take this extra step
# once the {pagedown} people get around to adding quarto support.

```

```{r setup, include=FALSE}
library(here)
library(ojodb)
library(ojothemes)
library(janitor)
library(gt)
library(gtExtras)
library(tidyverse)
library(nanoparquet)
library(ggrepel)

ojothemes::ojo_set_theme(theme = "okpi")

analysis_path <- here::here("data", "output", "jail_analysis_results.rds")
figures_path <- here::here("data", "output", "jail_figures.rds")

jail_analysis <- readRDS(analysis_path)
jail_figures <- readRDS(figures_path)

fmt_pct <- function(x) scales::percent(x, accuracy = 0.1)
fmt_num <- function(x) scales::comma(x, accuracy = 1)
audience <- match.arg(params$audience, c("internal", "external", "public"))
audience_show <- function(levels) audience %in% levels

# pull key metrics for executive summary
tulsa_adp_2025 <- jail_analysis$metrics_executive_summary |>
  filter(metric == "Average Daily Population (Tulsa County)") |>
  pull(value)

tulsa_adp_yoy_2025 <- jail_analysis$metrics_executive_summary |>
  filter(metric == "Average Daily Population (Tulsa County)") |>
  pull(yoy_change)

tulsa_bookings_2025 <- jail_analysis$metrics_executive_summary |>
  filter(metric == "Annual Bookings (Tulsa County)") |>
  pull(value)

tulsa_bookings_yoy_2025 <- jail_analysis$metrics_executive_summary |>
  filter(metric == "Annual Bookings (Tulsa County)") |>
  pull(yoy_change)
```

# Executive Summary
Tulsa County Jail's average daily population and bookings trended downward
in 2025 compared to 2024[, continuing a multi-year pattern of declines.]

- **The jail's average daily population (ADP) in 2025 is estimated to be
`r fmt_num(tulsa_adp_2025)`,
a
`r fmt_pct(tulsa_adp_yoy_2025)`
decrease from 2024.**
- **Total bookings to the jail in 2025 are estimated to be
`r fmt_num(tulsa_bookings_2025)`,
a
`r fmt_pct(tulsa_bookings_yoy_2025)`
decrease from 2024.**

```{r overview-metrics}
jail_figures$table_metrics_executive_summary
```

## Data limitations in 2025 mean estimates required cross-validation from multiple sources
In 2025, Tulsa County Jail (the David L. Moss Criminal Justice Center),
migrated its Jail Management System to a new vendor, 365Labs Public Safety Platform,
which impacted data availability and reporting capabilities for much of the year.
The jail's internal reporting tools were not fully functional for some time after
the migration, and prior web scrapers became non-fuctional after the new
community data portal was launched.

Given these unique challenges, this report attempts to provide an update on key
metrics for the jail population and bookings by using a variety of acquired data sources to
cross-validate estimates.

**The data sources used are:**

- **OK Policy's Scraper:** Data in OK Policy's database from a scraper developed by OK Policy.
  This scraper collected daily population data from the Tulsa County Jail's newest public data portal
  after the new portal was launched.
- **Jail Data Initiative's Scraper:** Data was acquired through a data sharing agreement
  with the Jail Data Intiative (JDI). JDI's data was collected via a web scraper
  that pulled daily population data from the Tulsa County Jail's public data portal
  before the new portal and after a several month gap, after the new portal launched.
- **Asemio's Scraper:** Data in OK Policy's database from a web scraper developed by Asemio. This scraper
  collected daily population data from the Tulsa County Jail's public data portal
  prior to the migration, but was not functional after the new portal was launched.
- **Past Starling Analytics Report:** Data from prior reports to GKFF by Starling Analytics
  which cite the source as Tulsa County's JailNet system.

Over the coming months, we will continue work with the Tulsa County jail
administrator and their IT staff to improve data access and reporting capabilities
to ensure accurate and timely information is available moving forward. We will also be
able to use that data to validate and refine the estimates presented in this report.


{{< pagebreak >}}

# Jail Bookings

## Total Bookings
```{r jail-bookings-mixmethod-total}
#| include: !expr audience_show(c("internal", "external"))
#| eval: !expr audience_show(c("internal", "external"))

jail_figures$plot_bookings_multiproducer_mixmethod_month_total
```

```{r jail-bookings-est-total}
jail_figures$plot_bookings_multiproducer_estimate_month_total
```

```{r jail-bookings-est-year}
jail_figures$plot_bookings_multiproducer_estimate_year_total

```

```{r jail-bookings-table}
#| include: !expr audience_show(c("internal", "external", "public"))
#| eval: !expr audience_show(c("internal", "external", "public"))

jail_figures$table_bookings_multiproducer_estimate_year_last_5_years_all
```

## Booking by Race
```{r jail-bookings-race}
#| include: !expr audience_show(c("internal", "external", "public"))
#| eval: !expr audience_show(c("internal", "external", "public"))

jail_figures$table_bookings_multiproducer_estimate_month_race
```

```{r jail-bookings-race-rate}
#| include: !expr audience_show(c("internal", "external", "public"))
#| eval: !expr audience_show(c("internal", "external", "public"))

jail_figures$plot_bookings_rate_multiproducer_estimate_month_race
```


## Booking by Gender
```{r jail-bookings-gender}
#| include: !expr audience_show(c("internal", "external", "public"))
#| eval: !expr audience_show(c("internal", "external", "public"))

jail_figures$plot_bookings_multiproducer_estimate_year_gender
```


## Bookings Compared to Other Counties

```{r jail-bookings-county}
#| include: !expr audience_show(c("internal", "external", "public"))
#| eval: !expr audience_show(c("internal", "external", "public"))

jail_figures$plot_bookings_multiproducer_estimate_yoy_all_county
```




# Jail Releases

Release data is unavailable due to a lack of information about where individuals were released to (e.g., to street, another facility, etc.).

## Total Jail Releases

```{r jail-releases-total}
#| include: !expr audience_show(c("internal", "external", "public"))
#| eval: !expr audience_show(c("internal", "external", "public"))

jail_figures$plot_releases_vera_admin_quarter_total
```

## Jail Releases by Gender

```{r jail-releases-gender}
#| include: !expr audience_show(c("internal", "external", "public"))
#| eval: !expr audience_show(c("internal", "external", "public"))

jail_figures$plot_releases_vera_admin_quarter_gender
```

## Jail Releases by Race

```{r jail-releases-race}
#| include: !expr audience_show(c("internal", "external", "public"))
#| eval: !expr audience_show(c("internal", "external", "public"))

jail_figures$plot_releases_vera_admin_quarter_race
```

## Jail Releases Compared to Other Counties

```{r jail-releases-county}
#| include: !expr audience_show(c("internal", "external", "public"))
#| eval: !expr audience_show(c("internal", "external", "public"))

jail_figures$plot_releases_vera_admin_quarter_yoy_county
```




# Average Daily Population

## Tulsa County Jail ADP
```{r jail-adp}
#| include: !expr audience_show(c("internal", "external", "public"))
#| eval: !expr audience_show(c("internal", "external", "public"))

jail_figures$plot_adp_multiproducer_estimate_year_total_county_gender
```


## Tulsa County Jail ADP by Race

```{r jail-adp-race}
#| include: !expr audience_show(c("internal", "external", "public"))
#| eval: !expr audience_show(c("internal", "external", "public"))

jail_figures$plot_adp_multiproducer_estimate_year_total_county_race
```


## Tulsa County Jail ADP by Gender

```{r jail-adp-mixmethod}
#| include: !expr audience_show(c("internal", "external"))
#| eval: !expr audience_show(c("internal", "external"))

jail_figures$plot_adp_multiproducer_mixmethod_year_total_county_gender
```


## Tulsa County Jail ADP Compared to Other Counties

```{r jail-adp-county}
#| include: !expr audience_show(c("internal", "external", "public"))
#| eval: !expr audience_show(c("internal", "external", "public"))

jail_figures$plot_adp_multiproducer_estimate_yoy_all_county
```


# Appendix Tables

## Bookings (Last 5 Years)
```{r jail-bookings-appendix}
#| include: !expr audience_show(c("internal", "external", "public"))
#| eval: !expr audience_show(c("internal", "external", "public"))

jail_figures$table_bookings_multiproducer_estimate_year_last_5_years_all
```

## Releases (Last 5 Years)
```{r jail-releases-appendix}
#| include: !expr audience_show(c("internal", "external", "public"))
#| eval: !expr audience_show(c("internal", "external", "public"))

jail_figures$table_releases_vera_admin_year_last_5_years_all
```
